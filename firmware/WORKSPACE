load(
    "@bazel_tools//tools/build_defs/repo:git.bzl",
    "git_repository",
)
load(
    "@bazel_tools//tools/build_defs/repo:http.bzl",
    "http_archive"
)

# custom AVR-specific rules
git_repository(
    name = "avr-bazel",
    commit = "b9af17ea27c463d2104d4240a7b3b44d55b29b23",
    remote = "https://github.com/taylorconor/avr-bazel",
)

load(
    "@avr-bazel//:avr.bzl",
    "avr_tools_repository",
)
avr_tools_repository()

# google test and google mock
git_repository(
    name = "gtest",
    commit = "703bd9caab50b139428cea1aaff9974ebee5742e",
    remote = "https://github.com/google/googletest",
)

# a local repo representing the third party library locations (e.g. for simavr).
# TODO: this is platform-specific and needs to be generalised.
new_local_repository(
    name = "third_party",
    path = "/usr/local/",
    workspace_file = "third_party/WORKSPACE.third_party",
    build_file = "third_party/BUILD.third_party",
)

# rules_foreign_cc for building makefile-based third-party projects
git_repository(
    name = "rules_foreign_cc",
    commit = "8b477ca9cb248fc472f152aa1a44c55ab71c4636",
    remote = "https://github.com/bazelbuild/rules_foreign_cc",
)

load(
    "@rules_foreign_cc//:workspace_definitions.bzl",
    "rules_foreign_cc_dependencies",
)
rules_foreign_cc_dependencies()

# simavr v1 .6
all_content = """filegroup(name = "all", srcs = glob(["**"]), visibility = ["//visibility:public"])"""
http_archive(
    name = "simavr",
    build_file_content = all_content,
    url = "https://github.com/buserror/simavr/archive/v1.6.zip",
)